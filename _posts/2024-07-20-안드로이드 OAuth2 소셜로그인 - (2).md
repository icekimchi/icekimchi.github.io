---
title: "ìŠ¤í”„ë§ë¶€íŠ¸ OAuth2 ì†Œì…œë¡œê·¸ì¸ ì„¤ì • - (2)"
date: 2024-07-20 17:00:00 +0900
categories: [Project, í•´ìƒë¬¼ë¥˜ICT ë©˜í† ë§]
tags: [JAVA, ìë°”, ì•ˆë“œë¡œì´ë“œ, ì–´í”Œ, PORT-MIS]
---

# ğŸ“Œ ì•ˆë“œë¡œì´ë“œ OAuth2 ì†Œì…œë¡œê·¸ì¸

### ğŸ‘‰ ê°œìš”

1ë²ˆì§¸ ê¸€ì—ì„œ í•˜ë ¤ê³  í–ˆë˜ ê²ƒì€ ì†Œì…œë¡œê·¸ì¸ ë¡œì§ì„ ëª¨ë‘ SpringBootì—ì„œ ì½”ë”©í•˜ëŠ” ê²ƒì´ì—ˆë‹¤.

1. ì•ˆë“œë¡œì´ë“œì—ì„œ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³´ë‚´ì¤Œ
2. ë°±ì—”ë“œì—ì„œ ì´ ê°’ì„ ì‚¬ìš©í•´ ì†Œì…œë¡œê·¸ì¸ì„ ì§„í–‰
3. í† í° ë°œí–‰
4. ì•ˆë“œë¡œì´ë“œì—ì„œ apië¥¼ ë‚ ë¦´ ë•Œ í† í°ì„ í•¨ê»˜ ì‚¬ìš©

ì´ë ‡ê²Œ ì‚¬ìš©í•˜ë ¤ê³  í–ˆì—ˆëŠ”ë°, ë§Œë“¤ë©´ì„œ ì°¾ì•„ë³´ê³  ì½”ë”©ì„ í•˜ë‹¤ë³´ë‹ˆ ë³€ê²½í•˜ê²Œ ë˜ì—ˆë‹¤.

1. ì•ˆë“œë¡œì´ë“œì—ì„œ ì†Œì…œë¡œê·¸ì¸ ì§„í–‰ í›„ Access Token ë°œí–‰
2. Access Tokenì„ ì„œë²„ë¡œ ë³´ë‚´ê³ , JWT ë°œí–‰
3. Jwtë¥¼ Shared Preferenceì— ì €ì¥
4. APIë¥¼ í˜¸ì¶œí•  ë•Œ Jwtë¥¼ í—¤ë”ì— ë„£ì–´ í˜¸ì¶œ

![alt text](/images/í•´ìƒë¬¼ë¥˜/07-20/LoginActivity.png)  
ì´ˆê¸°ì˜ í™”ë©´ì€ ì´ ì‚¬ì§„ê³¼ ê°™ë‹¤.

### ğŸ‘‰ ê¸°ëŠ¥

```
1. ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
2. ë„¤ì´ë²„ ë¡œê·¸ì¸
3. ì†Œì…œë¡œê·¸ì¸ì´ ì•„ë‹Œ ì´ë©”ì¼ë¡œ ê°€ì…
4. ë¡œê·¸ì¸í•˜ì§€ ì•Šê³  ì‹œì‘
```

### ğŸ‘‰ ì•ˆë“œë¡œì´ë“œì—ì„œ ì†Œì…œë¡œê·¸ì¸ êµ¬í˜„

![alt text](/images/í•´ìƒë¬¼ë¥˜/07-20/oauth2.png)

![alt text](/images/í•´ìƒë¬¼ë¥˜/07-20/directory.png)

Activityì—ì„œ ë‘ ì†Œì…œë¡œê·¸ì¸ì˜ ë¡œì§ì„ ë„£ê¸°ì—” ì½”ë“œê°€ ë„ˆë¬´ ê¸¸ì–´ì ¸ ë‘ LoginManager í´ë˜ìŠ¤ë¥¼ ë”°ë¡œ ë§Œë“¤ì—ˆë‹¤. ì‹¤ì œ ActivityëŠ” ì‹¤ì œ ë¡œê·¸ì¸ì„ í•˜ëŠ” ë¡œì§í•œ ë„£ì–´ ë§Œë“¤ì—ˆë‹¤.

#### ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸

```java
private void performKakaoLogin() {
        kakaoLoginManager.performLogin(this, new KakaoLoginManager.KakaoLoginCallback() {
            @Override
            public void onSuccess(OAuthToken token) {
                Log.i(TAG, "ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì„±ê³µ: " + token.getAccessToken());
                kakaoLoginManager.kakaoSocialLogin(token.getAccessToken(), new KakaoLoginManager.SocialLoginCallback() {
                    @Override
                    public void onSuccess(String message) {
                        Toast.makeText(LoginActivity.this, message, Toast.LENGTH_SHORT).show();
                        // TODO: ë¡œê·¸ì¸ í›„ ì±„íŒ…ë°© í™”ë©´ìœ¼ë¡œ ì´ë™
                        Intent intent = new Intent(LoginActivity.this, ChatRoomActivity.class);
                        startActivity(intent);
                        finish(); // í˜„ì¬ LoginActivityë¥¼ ì¢…ë£Œ (ì„ íƒì‚¬í•­)
                    }

                    @Override
                    public void onFailure(String error) {
                        Toast.makeText(LoginActivity.this, error, Toast.LENGTH_SHORT).show();
                    }
                });
            }

            @Override
            public void onFailure(Throwable error) {
                Log.e(TAG, "ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹¤íŒ¨", error);
                Toast.makeText(LoginActivity.this, "ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹¤íŒ¨", Toast.LENGTH_SHORT).show();
            }
        });
    }
```

#### ë„¤ì´ë²„ ë¡œê·¸ì¸

```java
private final ActivityResultLauncher<Intent> naverLauncher = registerForActivityResult(
            new ActivityResultContracts.StartActivityForResult(),
            result -> {
                NaverLoginManager.handleLoginResult(result.getResultCode(), new NaverLoginManager.NaverLoginCallback() {
                    @Override
                    public void onSuccess(String accessToken) {
                        naverLoginManager.naverSocialLogin(accessToken, LoginActivity.this);
                        Log.i(TAG, "ë„¤ì´ë²„ ë¡œê·¸ì¸ ì„±ê³µ: " + accessToken);
                        // TODO: ì¶”ê°€ ì‘ì—… ìˆ˜í–‰
                        Intent intent = new Intent(LoginActivity.this, ChatRoomActivity.class);
                        startActivity(intent);
                        finish(); // í˜„ì¬ LoginActivityë¥¼ ì¢…ë£Œ
                    }

                    @Override
                    public void onFailure(String errorCode, String errorDescription) {
                        Log.e(TAG, "ë„¤ì´ë²„ ë¡œê·¸ì¸ ì‹¤íŒ¨: " + errorCode + " - " + errorDescription);
                    }
                });
            }
    );
```

#### ì´ë©”ì¼ë¡œ ë¡œê·¸ì¸(ì†Œì…œë¡œê·¸ì¸ X) -> ìƒˆë¡œìš´ ì—‘í‹°ë¹„í‹°ë¡œ ì´ë™

```java
private void performEmailLogin() {
        // ì´ë©”ì¼ ë¡œê·¸ì¸ ë¡œì§ êµ¬í˜„
        Intent intent = new Intent(this, EmailLoginActivity.class);
        startActivity(intent);
    }
```
